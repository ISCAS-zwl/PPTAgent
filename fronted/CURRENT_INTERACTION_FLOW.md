# å‰åç«¯ç³»ç»Ÿä¸ DeepPresenter äº¤äº’æµç¨‹è¯¦è§£

## ğŸ¯ å½“å‰çŠ¶æ€åˆ†æ

### âš ï¸ é‡è¦å‘ç°

æŸ¥çœ‹ä»£ç åå‘ç°ï¼Œ**å½“å‰ç³»ç»Ÿè¿˜æ²¡æœ‰çœŸæ­£ä¸ DeepPresenter äº¤äº’**ï¼

åŸå› ï¼š
1. `task_processor.py` ç¬¬ 7 è¡Œå¯¼å…¥çš„æ˜¯ **æ—§ç‰ˆæœ¬** çš„é›†æˆæ¨¡å—ï¼š
   ```python
   from app.services.pptagent_integration import pptagent_integration  # æ—§ç‰ˆæœ¬
   ```

2. æ–°åˆ›å»ºçš„ `pptagent_integration_v2.py` å’Œ `pptagent_docker_client.py` **è¿˜æ²¡æœ‰è¢«ä½¿ç”¨**

3. å½“å‰ä½¿ç”¨çš„æ˜¯ **æ¨¡æ‹Ÿæ•°æ®**ï¼Œæ²¡æœ‰çœŸæ­£è°ƒç”¨ DeepPresenter

---

## ğŸ“Š å½“å‰å®é™…äº¤äº’æµç¨‹ï¼ˆä½¿ç”¨æ—§ç‰ˆæœ¬ï¼‰

```
ç”¨æˆ·åœ¨å‰ç«¯è¾“å…¥éœ€æ±‚
    â†“
å‰ç«¯å‘é€ POST /api/task/create
    â†“
åç«¯åˆ›å»ºä»»åŠ¡å¹¶æ”¾å…¥é˜Ÿåˆ—
    â†“
TaskProcessor.process_task() å¤„ç†ä»»åŠ¡
    â†“
è°ƒç”¨ pptagent_integration.generate_ppt()  â† æ—§ç‰ˆæœ¬
    â†“
å°è¯•å¯¼å…¥æœ¬åœ° PPTAgent æ¨¡å—
    â”œâ”€ æˆåŠŸ â†’ è°ƒç”¨æœ¬åœ°æ¨¡å—ï¼ˆä½†å®é™…ä»£ç è¢«æ³¨é‡Šäº†ï¼‰
    â””â”€ å¤±è´¥ â†’ ä½¿ç”¨åå¤‡æ–¹æ¡ˆï¼ˆç”Ÿæˆ Markdown å¤§çº²ï¼‰
    â†“
è¿”å›æ¨¡æ‹Ÿç»“æœç»™å‰ç«¯
```

**å½“å‰è¡Œä¸º**ï¼š
- âœ… å‰ç«¯å¯ä»¥åˆ›å»ºä»»åŠ¡
- âœ… åç«¯å¯ä»¥å¤„ç†ä»»åŠ¡
- âŒ **æ²¡æœ‰çœŸæ­£è°ƒç”¨ DeepPresenter**
- âœ… ä½¿ç”¨åå¤‡æ–¹æ¡ˆç”Ÿæˆ Markdown å¤§çº²

---

## ğŸ”„ åº”è¯¥çš„äº¤äº’æµç¨‹ï¼ˆä½¿ç”¨æ–°ç‰ˆæœ¬ V2ï¼‰

### å®Œæ•´æµç¨‹å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    1. ç”¨æˆ·äº¤äº’å±‚                                  â”‚
â”‚  ç”¨æˆ·åœ¨å‰ç«¯è¾“å…¥: "åˆ›å»ºä¸€ä¸ªå…³äºäººå·¥æ™ºèƒ½çš„æ¼”ç¤ºæ–‡ç¨¿"                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    2. å‰ç«¯ (Next.js)                             â”‚
â”‚  - ç”¨æˆ·ç‚¹å‡»"ç”Ÿæˆ"æŒ‰é’®                                             â”‚
â”‚  - å‘é€ POST http://localhost:8000/api/task/create              â”‚
â”‚  - è¯·æ±‚ä½“: { "prompt": "...", "sample_count": 2 }               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    3. åç«¯ API (FastAPI)                         â”‚
â”‚  app/api/tasks.py:                                              â”‚
â”‚  - æ¥æ”¶è¯·æ±‚                                                      â”‚
â”‚  - åˆ›å»º Task å¯¹è±¡                                                â”‚
â”‚  - ä¿å­˜åˆ° Redis                                                  â”‚
â”‚  - æ”¾å…¥ä»»åŠ¡é˜Ÿåˆ—: await task_queue.put(task)                      â”‚
â”‚  - ç«‹å³è¿”å›: { "task_id": "uuid", "status": "created" }         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    4. ä»»åŠ¡å¤„ç†å™¨ (åå°)                           â”‚
â”‚  app/tasks/task_processor.py:                                   â”‚
â”‚  - ä»é˜Ÿåˆ—å–å‡ºä»»åŠ¡                                                 â”‚
â”‚  - æ›´æ–°çŠ¶æ€ä¸º RUNNING                                            â”‚
â”‚  - é€šè¿‡ WebSocket é€šçŸ¥å‰ç«¯                                       â”‚
â”‚  - è°ƒç”¨: await TaskProcessor._generate_artifact(task)           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    5. é›†æˆå±‚ V2 (å…³é”®ï¼)                          â”‚
â”‚  app/services/pptagent_integration_v2.py:                       â”‚
â”‚                                                                 â”‚
â”‚  await pptagent_integration_v2.generate_ppt(                    â”‚
â”‚      prompt=task.prompt,                                        â”‚
â”‚      options=task.options                                       â”‚
â”‚  )                                                              â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚  â”‚  æ¨¡å¼é€‰æ‹©é€»è¾‘ (_select_mode)             â”‚                   â”‚
â”‚  â”‚                                         â”‚                   â”‚
â”‚  â”‚  if mode == AUTO:                       â”‚                   â”‚
â”‚  â”‚      if docker_available:               â”‚                   â”‚
â”‚  â”‚          return "docker"  â† ä¼˜å…ˆé€‰æ‹©     â”‚                   â”‚
â”‚  â”‚      elif local_agent:                  â”‚                   â”‚
â”‚  â”‚          return "local"                 â”‚                   â”‚
â”‚  â”‚      else:                               â”‚                   â”‚
â”‚  â”‚          return "fallback"              â”‚                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â†“                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  6a. Docker æ¨¡å¼      â”‚  â”‚  6b. Local æ¨¡å¼              â”‚
â”‚  (æ¨è)              â”‚  â”‚  (å¤‡é€‰)                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              7. PPTAgent Docker å®¢æˆ·ç«¯                           â”‚
â”‚  app/services/pptagent_docker_client.py:                        â”‚
â”‚                                                                 â”‚
â”‚  await pptagent_docker_client.generate_ppt(                     â”‚
â”‚      prompt="åˆ›å»ºä¸€ä¸ªå…³äºäººå·¥æ™ºèƒ½çš„æ¼”ç¤ºæ–‡ç¨¿",                      â”‚
â”‚      options={                                                  â”‚
â”‚          "template": "default",                                 â”‚
â”‚          "style": "professional"                                â”‚
â”‚      }                                                          â”‚
â”‚  )                                                              â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚  â”‚  HTTP è¯·æ±‚æ„å»º                           â”‚                   â”‚
â”‚  â”‚                                         â”‚                   â”‚
â”‚  â”‚  POST http://deeppresenter-host:7861/api/generate          â”‚
â”‚  â”‚  Content-Type: application/json         â”‚                   â”‚
â”‚  â”‚  {                                      â”‚                   â”‚
â”‚  â”‚    "prompt": "...",                     â”‚                   â”‚
â”‚  â”‚    "template": "default",               â”‚                   â”‚
â”‚  â”‚    "style": "professional"              â”‚                   â”‚
â”‚  â”‚  }                                      â”‚                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              8. DeepPresenter (Docker å®¹å™¨)                      â”‚
â”‚  å®¹å™¨å: deeppresenter-host                                      â”‚
â”‚  ç«¯å£: 7861                                                      â”‚
â”‚  ç½‘ç»œ: pptagent-shared-network                                  â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚  â”‚  æ¥æ”¶ HTTP è¯·æ±‚                          â”‚                   â”‚
â”‚  â”‚  â†“                                      â”‚                   â”‚
â”‚  â”‚  è°ƒç”¨ PPTAgent æ ¸å¿ƒå¼•æ“                  â”‚                   â”‚
â”‚  â”‚  â†“                                      â”‚                   â”‚
â”‚  â”‚  ç”Ÿæˆ PPT æ–‡ä»¶                           â”‚                   â”‚
â”‚  â”‚  â†“                                      â”‚                   â”‚
â”‚  â”‚  è¿”å›ç»“æœ:                               â”‚                   â”‚
â”‚  â”‚  {                                      â”‚                   â”‚
â”‚  â”‚    "success": true,                     â”‚                   â”‚
â”‚  â”‚    "content": "...",                    â”‚                   â”‚
â”‚  â”‚    "file_path": "/workspace/output.pptx"â”‚                   â”‚
â”‚  â”‚  }                                      â”‚                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              9. ç»“æœè¿”å›                                          â”‚
â”‚  Docker å®¢æˆ·ç«¯ â†’ é›†æˆå±‚ V2 â†’ ä»»åŠ¡å¤„ç†å™¨                           â”‚
â”‚                                                                 â”‚
â”‚  åˆ›å»º Artifact å¯¹è±¡:                                             â”‚
â”‚  {                                                              â”‚
â”‚    "type": "PPT",                                               â”‚
â”‚    "content": "ç”Ÿæˆçš„å†…å®¹",                                       â”‚
â”‚    "file_path": "/workspace/output.pptx"                        â”‚
â”‚  }                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              10. WebSocket å®æ—¶æ¨é€                              â”‚
â”‚  - æ›´æ–°ä»»åŠ¡çŠ¶æ€ä¸º COMPLETED                                       â”‚
â”‚  - ä¿å­˜åˆ° Redis                                                  â”‚
â”‚  - é€šè¿‡ WebSocket æ¨é€ç»™å‰ç«¯:                                     â”‚
â”‚    {                                                            â”‚
â”‚      "type": "complete",                                        â”‚
â”‚      "task_id": "uuid",                                         â”‚
â”‚      "artifact": { ... }                                        â”‚
â”‚    }                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              11. å‰ç«¯æ˜¾ç¤ºç»“æœ                                     â”‚
â”‚  - æ¥æ”¶ WebSocket æ¶ˆæ¯                                           â”‚
â”‚  - æ›´æ–° Zustand Store                                           â”‚
â”‚  - ArtifactViewer ç»„ä»¶æ¸²æŸ“ç»“æœ                                   â”‚
â”‚  - ç”¨æˆ·å¯ä»¥æŸ¥çœ‹ã€ä¸‹è½½ PPT                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”§ éœ€è¦ä¿®æ”¹çš„åœ°æ–¹

### 1. æ›´æ–° task_processor.py

**å½“å‰ä»£ç **ï¼ˆç¬¬ 7 è¡Œï¼‰ï¼š
```python
from app.services.pptagent_integration import pptagent_integration  # æ—§ç‰ˆæœ¬
```

**éœ€è¦æ”¹ä¸º**ï¼š
```python
from app.services.pptagent_integration_v2 import pptagent_integration_v2
```

**å¹¶ä¸”ä¿®æ”¹ç¬¬ 160 è¡Œ**ï¼š
```python
# å½“å‰
result = await pptagent_integration.generate_ppt(
    prompt=task.prompt,
    options=task.options
)

# æ”¹ä¸º
result = await pptagent_integration_v2.generate_ppt(
    prompt=task.prompt,
    options=task.options
)
```

---

## ğŸŒ ç½‘ç»œé€šä¿¡è¯¦è§£

### Docker å®¹å™¨é—´é€šä¿¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         pptagent-shared-network (172.18.0.0/16)         â”‚
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ pptagent-backend     â”‚      â”‚ deeppresenter-host   â”‚â”‚
â”‚  â”‚ IP: 172.18.0.2       â”‚â”€â”€â”€â”€â”€â†’â”‚ IP: 172.18.0.3       â”‚â”‚
â”‚  â”‚ Port: 8000           â”‚      â”‚ Port: 7861           â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                         â”‚
â”‚  é€šä¿¡æ–¹å¼:                                               â”‚
â”‚  http://deeppresenter-host:7861/api/generate           â”‚
â”‚  (Docker è‡ªåŠ¨è§£æå®¹å™¨ååˆ° IP)                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### HTTP è¯·æ±‚ç¤ºä¾‹

```http
POST http://deeppresenter-host:7861/api/generate
Content-Type: application/json
Authorization: Bearer <token>  (å¦‚æœéœ€è¦)

{
  "prompt": "åˆ›å»ºä¸€ä¸ªå…³äºäººå·¥æ™ºèƒ½çš„æ¼”ç¤ºæ–‡ç¨¿",
  "template": "default",
  "style": "professional",
  "output_format": "pptx"
}
```

### HTTP å“åº”ç¤ºä¾‹

```json
{
  "success": true,
  "content": "# äººå·¥æ™ºèƒ½æ¼”ç¤ºæ–‡ç¨¿\n\n## ç¬¬ä¸€éƒ¨åˆ†...",
  "file_path": "/workspace/output_20260131_123456.pptx",
  "metadata": {
    "template": "default",
    "style": "professional",
    "slides_count": 10,
    "generation_time": 25.3
  }
}
```

---

## ğŸ“ æ•°æ®æµè½¬è¯¦è§£

### 1. ä»»åŠ¡åˆ›å»ºé˜¶æ®µ

```python
# å‰ç«¯å‘é€
{
  "prompt": "åˆ›å»ºä¸€ä¸ªå…³äºäººå·¥æ™ºèƒ½çš„æ¼”ç¤ºæ–‡ç¨¿",
  "sample_count": 2
}

# åç«¯åˆ›å»º Task å¯¹è±¡
Task(
  id="550e8400-e29b-41d4-a716-446655440000",
  prompt="åˆ›å»ºä¸€ä¸ªå…³äºäººå·¥æ™ºèƒ½çš„æ¼”ç¤ºæ–‡ç¨¿",
  status=TaskStatus.IDLE,
  samples=[
    Sample(id="550e8400-...-sample-0", status=IDLE),
    Sample(id="550e8400-...-sample-1", status=IDLE)
  ],
  options={}
)

# ä¿å­˜åˆ° Redis
redis.set(
  "task:550e8400-...",
  json.dumps(task),
  ex=86400  # 24å°æ—¶è¿‡æœŸ
)
```

### 2. ä»»åŠ¡å¤„ç†é˜¶æ®µ

```python
# ä»é˜Ÿåˆ—å–å‡ºä»»åŠ¡
task = await task_queue.get()

# æ›´æ–°çŠ¶æ€
task.status = TaskStatus.RUNNING

# WebSocket æ¨é€
await manager.send_to_task_subscribers(
  task.id,
  {
    "type": "status",
    "task_id": task.id,
    "status": "running"
  }
)
```

### 3. PPT ç”Ÿæˆé˜¶æ®µ

```python
# è°ƒç”¨é›†æˆå±‚
result = await pptagent_integration_v2.generate_ppt(
  prompt=task.prompt,
  options=task.options
)

# é›†æˆå±‚é€‰æ‹©æ¨¡å¼
mode = self._select_mode()  # è¿”å› "docker"

# è°ƒç”¨ Docker å®¢æˆ·ç«¯
result = await pptagent_docker_client.generate_ppt(
  prompt="åˆ›å»ºä¸€ä¸ªå…³äºäººå·¥æ™ºèƒ½çš„æ¼”ç¤ºæ–‡ç¨¿",
  options={"template": "default", "style": "professional"}
)

# Docker å®¢æˆ·ç«¯å‘é€ HTTP è¯·æ±‚
response = await self.client.post(
  "http://deeppresenter-host:7861/api/generate",
  json={
    "prompt": "åˆ›å»ºä¸€ä¸ªå…³äºäººå·¥æ™ºèƒ½çš„æ¼”ç¤ºæ–‡ç¨¿",
    "template": "default",
    "style": "professional"
  }
)

# è¿”å›ç»“æœ
return {
  "success": True,
  "content": "...",
  "file_path": "/workspace/output.pptx"
}
```

### 4. ç»“æœè¿”å›é˜¶æ®µ

```python
# åˆ›å»º Artifact
artifact = Artifact(
  type=ArtifactType.PPT,
  content=result["content"],
  language="pptx"
)

# æ›´æ–°ä»»åŠ¡
task.status = TaskStatus.COMPLETED
task.artifact = artifact

# WebSocket æ¨é€å®Œæˆæ¶ˆæ¯
await manager.send_to_task_subscribers(
  task.id,
  {
    "type": "complete",
    "task_id": task.id,
    "artifact": artifact.model_dump()
  }
)
```

---

## ğŸ¯ å…³é”®ä»£ç ä½ç½®

| åŠŸèƒ½ | æ–‡ä»¶ | è¡Œå· |
|------|------|------|
| ä»»åŠ¡åˆ›å»º API | `app/api/tasks.py` | 18-55 |
| ä»»åŠ¡å¤„ç†å…¥å£ | `app/tasks/task_processor.py` | 14-72 |
| PPT ç”Ÿæˆè°ƒç”¨ | `app/tasks/task_processor.py` | 160 |
| é›†æˆå±‚ V2 | `app/services/pptagent_integration_v2.py` | å…¨æ–‡ |
| Docker å®¢æˆ·ç«¯ | `app/services/pptagent_docker_client.py` | å…¨æ–‡ |
| æ¨¡å¼é€‰æ‹©é€»è¾‘ | `pptagent_integration_v2.py` | 86-104 |
| HTTP è¯·æ±‚å‘é€ | `pptagent_docker_client.py` | 37-85 |

---

## âš ï¸ å½“å‰é—®é¢˜æ€»ç»“

1. **æœªä½¿ç”¨æ–°ç‰ˆæœ¬é›†æˆæ¨¡å—**
   - `task_processor.py` è¿˜åœ¨ä½¿ç”¨æ—§ç‰ˆæœ¬
   - éœ€è¦ä¿®æ”¹å¯¼å…¥è¯­å¥

2. **DeepPresenter API ç«¯ç‚¹æœªç¡®è®¤**
   - å½“å‰ä½¿ç”¨çš„ `/api/generate` æ˜¯å‡è®¾çš„
   - éœ€è¦æŸ¥çœ‹ DeepPresenter å®é™… API æ–‡æ¡£

3. **ç½‘ç»œæœªé…ç½®**
   - éœ€è¦åˆ›å»ºå…±äº«ç½‘ç»œæˆ–ä½¿ç”¨ host ç½‘ç»œ
   - ç¡®ä¿å®¹å™¨é—´å¯ä»¥é€šä¿¡

---

## âœ… ä¸‹ä¸€æ­¥è¡ŒåŠ¨

1. **ä¿®æ”¹ task_processor.py** ä½¿ç”¨æ–°ç‰ˆæœ¬é›†æˆæ¨¡å—
2. **é…ç½® Docker ç½‘ç»œ** è®©å®¹å™¨é—´å¯ä»¥é€šä¿¡
3. **ç¡®è®¤ DeepPresenter API** è°ƒæ•´è¯·æ±‚æ ¼å¼
4. **æµ‹è¯•å®Œæ•´æµç¨‹** éªŒè¯äº¤äº’æ˜¯å¦æ­£å¸¸

éœ€è¦æˆ‘å¸®ä½ å®Œæˆè¿™äº›ä¿®æ”¹å—ï¼Ÿ
